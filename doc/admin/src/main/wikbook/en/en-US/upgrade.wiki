h1. Purpose {anchor:id=ADM.Upgrade.Purpose}

Updating your eXo Platform server is fairly easy but remains critical. This document presents the detailed steps to upgrade eXo Platform server.

h1. Modifications details between versions {anchor:id=ADM.Upgrade.Modification_details}

h2. Modifications between Platform v.3.0.1 and 3.0.2 {anchor:id=ADM.Upgrade.Modification_details.3.0.1_3.0.2}
{note}
To further understand about ECMS Application templates, refer to [here.|http://docs.exoplatform.org/PLF30/refguide/html/bk03ch03.html#CONTref.Configuration.Templates.Application_template]
{note}
It is about Groovy template files (.gtmpl) stored in the JCR. These templates are used by the *Content List Portlet* and *Category Navigation Portlet* to diplay content lists in a pagination mode.
There are four template types available, including:

* *Content List* templates.
* *Parameterized Content List* templates.
* *Category Navigation* templates.
* *Paginator* templates.

In eXo Platform 3.0.1, those templates are stored in the same location in the JCR. But in eXo Platform 3.0.3, their locations are separated to be clearer for the end user.

h2. Modifications between eXo Platform v.3.0.2 to 3.0.3 {anchor:id=ADM.Upgrade.Modification_details.3.0.2_3.0.3}

*Gadgets*

Gadgets predefined in eXo Platform are stored in the JCR, so if you have already used eXo Platform in the production mode, delete those gadgets to get new ones defined in the new eXo Platform package. However, in case of the development mode, which means JCR database could be removed, those gadgets are auto-refreshed when upgrading server.

* Modified gadgets:
** *Upcoming Events*
** *To-do* (renamed to *Todo* )
** *IDE*
** *Poll*
** *Status Update* (renamed to *Activity Stream*)
** *Viewer Friends Gadgets* (renamed to *My Connections*)
** *Upcoming tasks* (renamed to *My Tasks*)
** *RSSFetch* (renamed to *SocialRssReader*)
* Deleted gadgets:
** *Published Documents*
** *Last Edited Documents*
** *My documents*
** *ApplicationRegistryGadget*
** *Social Hello World*
** *Code Sharing*
** *RssFetcherGadget*
** *Clock*
** *CodeRunner - OpenSocial Deve...*
** *Space List*
* Added gadgets:
** None

See the instructions below to refresh those gadgets in production mode.

h2. Modifications between Platform v.3.0.3 and 3.0.4 {anchor:id=ADM.Upgrade.Modification_details.3.0.3_3.0.4}

* It is not required to make any modifications.

h1. Steps to upgrade {anchor:id=ADM.Upgrade.Steps_Upgrade}

h2. Development mode {anchor:id=ADM.Upgrade.Development_mode}

In this mode, you are supposed to use eXo Platform with a clean database, which means you can delete the database tables without impacting your development. 

Also, try the following steps in the *Production mode* section below.

*1.* Stop the Platform server.

*2.* Clean up your JCR database tables (Drop JCR Datasource tables).

*3.* Backup your files before proceeding to the upgrade.

*4.* Replace the old eXo Platform binaries with the new ones:

* Tomcat: make sure that the new Tomcat content is used.
* JBoss: replace the old EAR package with the new one, including the *gatein.ear* folder.

*5.* Apply modifications defined in *DeliveryFolder/upgrade-notes/PLF302_CLV_Templates_Structure_Upgrade_Notice.pdf* in your custom configuration files.

*6.* Plug your custom configuration files and your custom datasources configuration into the new server.

*7.* Start the Platform Server to complete the upgrade.

h2. Production mode {anchor:id=ADM.Upgrade.Production_mode}

In this mode, you are supposed to keep your existing JCR data. Follow these steps:

*1.* Stop the Platform server.

*2.* Backup your Database and files before proceeding to the upgrade.

*3.* Replace the old eXo Platform binaries with the new ones.

*4.* Plug your custom configuration files and your custom data sources configuration into the new server.

*5.* Deploy crash web application is not deployed.

*6.* Start the new Platform server.

*7.* Connect to eXo Platform [CRaSH|http://crsh.googlecode.com/svn/doc/1.0.0-beta18/html/index.html] console by using the Telnet or SSH console to update gadgets predefined in eXo Platform:

{code}
   telnet localhost 5000
   connect -c portal -u root -p gtn portal-system
   rm /production/app:gadgets/app:eventslist
   rm /production/mop:workspace/mop:customizations/mop:Todo
   rm /production/app:gadgets/app:Todo
   select * from mop:workspaceclone where mop:contentid='Todo' | set mop:contentid "To-do"
   rm /production/mop:workspace/mop:customizations/mop:RSSFetch
   rm /production/app:gadgets/app:RSSFetch
   select * from mop:workspaceclone where mop:contentid='RSSFetch' | set mop:contentid "SocialRssReader"
   rm /production/app:gadgets/app:IDE
   rm /production/app:gadgets/app:pollslist
   rm /production/app:gadgets/app:Activities
   rm /production/app:gadgets/app:ViewerFriends
   rm /production/app:gadgets/app:taskslist
   commit
{code}

*8.* Restart the eXo Platform server to complete the upgrade.

*9.* The modifications defined in *DeliveryFolder/upgrade-notes/PLF302_CLV_Templates_Structure_Upgrade_Notice.pdf* are automatically applied:
{note}
Assuming you use a Platform 3.0.1 version, you can safely upgrade with no impact on your existing website. All impacted data will be migrated automatically at startup.
{note}